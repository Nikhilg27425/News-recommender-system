{% extends "base.html" %}

{% block title %}Dashboard - News Recommender{% endblock %}

{% block content %}
<div class="dashboard">
    <div class="dashboard-header">
        <h1>Welcome back, {{ username }}!</h1>
        <p>Discover personalized news recommendations</p>
    </div>

    <!-- Stats Section -->
    <div class="stats-section" id="stats">
        <div class="stat-card">
            <div class="stat-icon"><i class="fas fa-newspaper"></i></div>
            <div class="stat-info">
                <div class="stat-value" id="total-clicks">0</div>
                <div class="stat-label">Total Clicks</div>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon"><i class="fas fa-star"></i></div>
            <div class="stat-info">
                <div class="stat-value" id="unique-news">0</div>
                <div class="stat-label">News Read</div>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon"><i class="fas fa-tags"></i></div>
            <div class="stat-info">
                <div class="stat-value" id="favorite-category">-</div>
                <div class="stat-label">Favorite Category</div>
            </div>
        </div>
    </div>

    <!-- Controls Section -->
    <div class="controls-section">
        <div class="category-filter">
            <label for="category-select">Filter by Category:</label>
            <select id="category-select" class="category-select">
                <option value="all">All Categories</option>
            </select>
        </div>
        <button class="btn btn-secondary" onclick="fetchLatestNews()">
            <i class="fas fa-sync-alt"></i> Fetch Latest News
        </button>
    </div>

    <!-- Recommendations Section -->
    <section id="recommendations" class="news-section">
        <div class="section-header">
            <h2><i class="fas fa-star"></i> Personalized Recommendations</h2>
            <p>Based on your reading history</p>
        </div>
        <div class="news-grid" id="recommendations-grid">
            <div class="loading">Loading recommendations...</div>
        </div>
    </section>

    <!-- News Feed Section -->
    <section class="news-section">
        <div class="section-header">
            <h2><i class="fas fa-newspaper"></i> News Feed</h2>
            <p>Latest news from around the world</p>
        </div>
        <div class="news-grid" id="news-grid">
            <div class="loading">Loading news...</div>
        </div>
    </section>

    <!-- History Section -->
    <section id="history" class="news-section">
        <div class="section-header">
            <h2><i class="fas fa-history"></i> Reading History</h2>
            <p>Articles you've clicked on</p>
        </div>
        <div class="news-list" id="history-list">
            <div class="loading">Loading history...</div>
        </div>
    </section>
</div>

<!-- Fetch News Modal -->
<div id="fetch-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Fetch Latest News</h3>
            <button class="modal-close" onclick="closeFetchModal()">&times;</button>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label for="news-query">Search Query:</label>
                <input type="text" id="news-query" placeholder="e.g., technology, sports, finance" value="technology">
            </div>
            <div class="form-group">
                <label for="news-count">Number of Articles:</label>
                <input type="number" id="news-count" min="1" max="50" value="10">
            </div>
            <div id="fetch-status" class="fetch-status"></div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" onclick="closeFetchModal()">Cancel</button>
            <button class="btn btn-primary" onclick="submitFetchNews()">
                <i class="fas fa-download"></i> Fetch News
            </button>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
{% endblock %}

